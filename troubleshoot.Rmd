---
title: "Untitled"
output: html_document
date: "2024-01-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

```{r}
# Load pretend data
data <- data.frame(
  cue = c("ANCESTOR", "BISCUIT", "CANYON", "DIAMETER", "FREEWAY", 
          "LATIN", "LAUNDRY", "MODEL", "PORTRAY", "WELL"),
  target = c("FAMILY", "COOKIE", "MOUNTAIN", "LENGTH", "ROAD", 
             "FRENCH", "SOAP", "CAR", "SHOW", "DONE"),
  condition = c(2, 2, 1, 1, 2, 1, 1, 2, 1, 1),
  study_response = c(NA, NA, "CANYON", "LENGTH", NA, 
                     "FRENCH", "CLEAN", NA, "SHOW", "DONE"),
  study_rt = c(NA, NA, 2530, 2226, NA, 
               2248, 2138, NA, 1568, 1422),
  test_response = c("FAMILY", "COOKIE", "LOW", "LENGTH", "ROAD", 
                    "FRENCH", "SOAP", "CAR", "SHOW", "DONE"),
  test_rt = c(2263, 1812, 2209, 1650, 1473, 
              1528, 2232, 1311, 1262, 1479)
)

data <- data %>% mutate(index = row_number())
# To view the data frame
print(data)
```

```{r}
na_response_a <- data %>% 
      filter(condition == 1) %>% 
      group_by(study_response) %>% 
      add_count() %>%
      filter(n > 3) %>% 
      pull(index)

na_response_b <- data %>%
      filter(condition == 1) %>% 
      filter(nchar(study_response) < 3) %>% 
      pull(index)

na_response_c <- data %>%
      filter(condition == 1) %>% 
      filter(stringdist(tolower(study_response), tolower(cue), method = "lv") < 3) %>% 
      pull(index)

print(na_response_c)

```

```{r}
if (length(na_response_a) != 0 | length(na_response_b) != 0 | length(na_response_c) != 0) {
      remove <- c(na_response_a, na_response_b, na_response_c)
      filtered_data <- data %>%
        filter(!index %in% remove)
    } else{
      filtered_data <- data 
    }
```